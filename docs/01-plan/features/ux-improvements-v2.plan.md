# Plan: UX Improvements v2

## Overview

| Item | Description |
|------|-------------|
| Feature Name | ux-improvements-v2 |
| Created | 2026-02-11 |
| Author | Claude Opus 4.5 |
| Status | Draft |
| Priority | High |

## Problem Statement

### 이슈 1: 사이드바 캠페인 미노출

**현재 상태**:
- 계정 선택 후 사이드바에 캠페인 목록이 표시되지 않음
- URL에 `campaignId`가 있을 때만 캠페인 메뉴 표시됨

**원인 분석** (`src/components/layout/sidebar.tsx`):
- `getAccountNavItems()`: 계정 레벨 메뉴만 반환
- `getCampaignNavItems()`: URL에 campaignId가 있을 때만 사용
- **캠페인 목록을 API에서 불러와 표시하는 로직이 없음**

**기대 동작**:
- 계정 선택 시 해당 계정의 캠페인 목록이 사이드바에 표시
- 캠페인 클릭 시 캠페인 상세 페이지로 이동

---

### 이슈 2: 날짜 선택 "이번달" 버그

**현재 상태**:
- "이번달" 프리셋 선택 시 2월 1일이 아닌 1월 31일부터 선택됨

**코드 확인** (`src/components/filters/date-range-picker.tsx:62-67`):
```typescript
{
  label: '이번 달',
  getValue: () => ({
    from: startOfMonth(new Date()),  // 정상적으로 2월 1일 반환해야 함
    to: new Date(),
  }),
},
```

**가능한 원인**:
1. 타임존(UTC vs KST) 이슈
2. Calendar 컴포넌트의 날짜 처리 문제
3. date-fns 버전 또는 locale 설정 문제

---

### 이슈 3: 온보딩 절차 안내 부재

**현재 상태**:
- 계정 연동 후 "다음 단계" 안내 없음
- 사용자가 캠페인 정보/인사이트를 보기 위한 절차를 모름

**필요한 안내 내용**:
1. TikTok 계정 연동 완료
2. 데이터 동기화 대기 (최초 동기화 시간 안내)
3. 캠페인 목록 확인
4. AI 인사이트/전략 확인

---

## Requirements

### FR-01: 사이드바 캠페인 목록 표시

| ID | Requirement | Priority |
|----|-------------|----------|
| FR-01-1 | 계정 선택 시 해당 계정의 캠페인 목록을 사이드바에 표시 | Must |
| FR-01-2 | 캠페인 목록은 최대 10개까지 표시 (더보기 링크) | Should |
| FR-01-3 | 캠페인 클릭 시 `/accounts/{accountId}/campaigns/{campaignId}`로 이동 | Must |
| FR-01-4 | 캠페인 없을 때 "캠페인 없음" 메시지 표시 | Must |
| FR-01-5 | 로딩 중 스켈레톤 UI 표시 | Should |

### FR-02: 날짜 선택 버그 수정

| ID | Requirement | Priority |
|----|-------------|----------|
| FR-02-1 | "이번달" 선택 시 정확히 해당 월 1일부터 선택되도록 수정 | Must |
| FR-02-2 | 타임존 이슈 확인 및 KST 기준 처리 | Must |
| FR-02-3 | 모든 프리셋 날짜 정확성 검증 | Should |

### FR-03: 온보딩 절차 안내

| ID | Requirement | Priority |
|----|-------------|----------|
| FR-03-1 | 계정 연동 직후 "다음 단계" 안내 모달/배너 표시 | Must |
| FR-03-2 | 데이터 동기화 상태 표시 (진행 중/완료) | Should |
| FR-03-3 | 캠페인 없을 때 "캠페인 동기화" 안내 | Must |
| FR-03-4 | 인사이트 없을 때 "인사이트 생성 방법" 안내 | Should |

---

## Technical Approach

### FR-01: 사이드바 캠페인 목록

**수정 파일**: `src/components/layout/sidebar.tsx`

**구현 방안**:
1. `useSWR` 또는 `useEffect`로 캠페인 API 호출
2. 계정 메뉴 아래에 캠페인 목록 섹션 추가
3. Collapsible 컴포넌트로 접기/펼치기 지원

```typescript
// 추가할 로직 (의사코드)
const { data: campaigns } = useSWR(
  currentAccountId ? `/api/accounts/${currentAccountId}/campaigns?limit=10` : null
);

// 사이드바 렌더링
<NavSection title="캠페인">
  {campaigns?.map(campaign => (
    <NavItem href={`/accounts/${accountId}/campaigns/${campaign.id}`}>
      {campaign.name}
    </NavItem>
  ))}
</NavSection>
```

### FR-02: 날짜 선택 버그

**수정 파일**: `src/components/filters/date-range-picker.tsx`

**확인 사항**:
1. `startOfMonth(new Date())`의 실제 반환값 확인
2. 필요 시 명시적 타임존 처리 추가

```typescript
// 수정안 (필요 시)
import { startOfMonth } from 'date-fns';

// KST 기준으로 처리
const getKSTStartOfMonth = () => {
  const now = new Date();
  const kstOffset = 9 * 60; // KST = UTC+9
  const kstDate = new Date(now.getTime() + kstOffset * 60 * 1000);
  return startOfMonth(kstDate);
};
```

### FR-03: 온보딩 안내

**신규 파일**: `src/components/onboarding/setup-guide.tsx`

**구현 방안**:
1. 계정 연동 직후 표시되는 안내 컴포넌트
2. 단계별 체크리스트 형식
3. 각 단계 완료 시 자동 체크

```typescript
// 온보딩 단계
const steps = [
  { id: 'connect', label: 'TikTok 계정 연동', completed: true },
  { id: 'sync', label: '데이터 동기화', completed: campaigns.length > 0 },
  { id: 'campaigns', label: '캠페인 확인', completed: false },
  { id: 'insights', label: 'AI 인사이트 확인', completed: false },
];
```

---

## Files to Modify/Create

| Action | File | Purpose |
|--------|------|---------|
| Modify | `src/components/layout/sidebar.tsx` | 캠페인 목록 표시 |
| Modify | `src/components/layout/mobile-sidebar.tsx` | 모바일 캠페인 목록 |
| Modify | `src/components/filters/date-range-picker.tsx` | 날짜 버그 수정 |
| Create | `src/components/onboarding/setup-guide.tsx` | 온보딩 안내 컴포넌트 |
| Modify | `src/app/(dashboard)/accounts/[accountId]/page.tsx` | 온보딩 안내 통합 |

---

## Checklist

### Phase 1: 날짜 버그 수정 (우선)
- [ ] "이번달" 프리셋 버그 원인 확인
- [ ] 타임존 처리 추가 (필요 시)
- [ ] 모든 프리셋 검증

### Phase 2: 사이드바 캠페인 표시
- [ ] 캠페인 API 연동
- [ ] 캠페인 목록 UI 추가
- [ ] 로딩/에러 상태 처리
- [ ] 모바일 사이드바 동기화

### Phase 3: 온보딩 안내
- [ ] SetupGuide 컴포넌트 생성
- [ ] 계정 대시보드에 통합
- [ ] 단계별 완료 상태 로직

---

## Success Metrics

| Metric | Target |
|--------|--------|
| 사이드바 캠페인 표시 | 계정 선택 시 즉시 표시 |
| 날짜 선택 정확도 | 100% (프리셋 선택 시 정확한 날짜) |
| 온보딩 완료율 | 첫 방문 사용자의 절차 이해도 향상 |

---

## Next Steps

1. `/pdca design ux-improvements-v2` - 상세 설계 문서 작성
2. 또는 바로 구현 시작 (간단한 수정 먼저)

---

*Generated by bkit PDCA Skill v1.5.0*
